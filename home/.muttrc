# vim: filetype=muttrc
set charset=UTF-8

set folder=~/.mail/
source ~/.mutt/mailboxes

set spoolfile=+markus/INBOX
set postponed=+markus/drafts
set record=+markus/sent
set header_cache = ~/.mutt/cache/headers
set message_cachedir = ~/.mutt/cache/bodies

set sleep_time = 0  # don't wait between mailbox switch
set delete
set quit
unset help  # hardcore!
unset mark_old
unset wait_key

set folder_format="%2C %2N %2s %f"
set editor="vim -c 'set textwidth=79'"
set trash=+markus/trash  # confirmed for working 2012-08-31
set tilde


unset confirmappend
set quit
unset markers # don't add plus signs to wrapped urls (needed for url selection in urxvt)
unset mark_old
set query_command= "abook --mutt-query '%s'"
auto_view text/html
alternative_order text/plain text/html text/enriched

# sidebar
set sidebar_visible = yes
set sidebar_width = 24
bind index,pager <right> sidebar-open
bind index,pager <down> sidebar-next
bind index,pager <up> sidebar-prev
set sidebar_delim = ' '

# messages index
folder-hook . "exec collapse-all"
set sort=threads
bind index gg first-entry
bind index G last-entry
bind index,pager R reply
bind index,pager r group-reply
bind index <space> collapse-thread

macro index,pager C "<copy-message>?<toggle-mailboxes>" "copy a message to a mailbox"
macro index,pager M "<save-message>?<toggle-mailboxes>" "move a message to a mailbox"

macro index,pager s "<save-message>+markus/archive <enter>" "archive"
macro index,pager \CS "<tag-thread><tag-prefix>s" "archive thread"

set index_format="%4C %Z%?y?@& ? %{%b %d} %-15.15L <%?M?%03M&%4l?> %s"
unset collapse_unread

macro index,pager F \
    "<shell-escape>/usr/bin/notmuch-mutt --prompt search<enter><change-folder-readonly>~/.cache/notmuch/mutt/results<enter>" \
    "search mail, using notmuch"
macro index,pager \" \
    "<pipe-message>/usr/bin/notmuch-mutt thread<enter><change-folder-readonly>~/.cache/notmuch/mutt/results<enter>" \
    "search and reconstruct owning thread, using notmuch"


# messages
set pager_stop
set pager_index_lines = 12
bind pager gg top
bind pager G bottom
bind pager k previous-line
bind pager j next-line
bind pager K previous-undeleted
bind pager J next-undeleted


source /etc/Muttrc.gpg.dist

# server settings
set sendmail = "/usr/bin/msmtp"
set ssl_force_tls = yes
set ssl_starttls = yes

set from="markus@unterwaditzer.net"
set realname="Markus Unterwaditzer"

# GNUPG
#
set pgp_use_gpg_agent=yes
set pgp_sign_as=0xFAAC788C
set pgp_timeout=60

set crypt_replysign=yes
set crypt_autoencrypt=no
set crypt_replyencrypt=no
set crypt_replysignencrypted=yes

set crypt_verify_sig=yes

source ~/.dotfiledata/solarized_mutt/mutt-colors-solarized-dark-16.muttrc
